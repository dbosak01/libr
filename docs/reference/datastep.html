<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Step through data row-by-row — datastep • libr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Step through data row-by-row — datastep"><meta property="og:description" content="The datastep function allows you to perform
row-wise conditional processing on a data frame, data table, or tibble.
The function
contains parameters to drop, keep, or rename variables, perform
by-group processing, and perform row-wise or column-wise calculations."><meta property="og:image" content="https://libr.r-sassy.org/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">libr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"></ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../articles/libr.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/libr-basics.html">Basic Library Operations</a>
    </li>
    <li>
      <a href="../articles/libr-management.html">Library Management</a>
    </li>
    <li>
      <a href="../articles/libr-datastep.html">Data Step Operations</a>
    </li>
    <li>
      <a href="../articles/libr-disclaimer.html">Disclaimer</a>
    </li>
    <li>
      <a href="../articles/libr-example1.html">Complete Example 1</a>
    </li>
    <li>
      <a href="../articles/libr-example2.html">Complete Example 2</a>
    </li>
    <li>
      <a href="../articles/libr-faq.html">Frequently Asked Questions</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href=".././articles/libr-faq.html">FAQ</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://github.com/dbosak01/libr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Step through data row-by-row</h1>
    <small class="dont-index">Source: <a href="https://github.com/dbosak01/libr/blob/HEAD/R/datastep.R" class="external-link"><code>R/datastep.R</code></a></small>
    <div class="hidden name"><code>datastep.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>datastep</code> function allows you to perform
row-wise conditional processing on a data frame, data table, or tibble.
The function
contains parameters to drop, keep, or rename variables, perform
by-group processing, and perform row-wise or column-wise calculations.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">datastep</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">steps</span>,</span>
<span>  keep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  drop <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rename <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  calculate <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  retain <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  attrib <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  arrays <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sort_check <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  format <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  where <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  set <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  merge <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  merge_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  merge_in <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>The data to step through.  This parameter is required. Valid
values are a data frame or a NULL. In the case of a NULL, you must include
at least one <code><a href="output.html">output()</a></code> function in the steps.</p></dd>


<dt id="arg-steps">steps<a class="anchor" aria-label="anchor" href="#arg-steps"></a></dt>
<dd><p>The operations to perform on the data.  This parameter is
specified as a set of R statements contained within
curly braces. If no steps are desired, pass empty curly braces.</p></dd>


<dt id="arg-keep">keep<a class="anchor" aria-label="anchor" href="#arg-keep"></a></dt>
<dd><p>A vector of quoted variable names to keep in the output
data set. By default, all variables are kept.</p></dd>


<dt id="arg-drop">drop<a class="anchor" aria-label="anchor" href="#arg-drop"></a></dt>
<dd><p>A vector of quoted variable names to drop from the output
data set. By default, no variables are dropped.</p></dd>


<dt id="arg-rename">rename<a class="anchor" aria-label="anchor" href="#arg-rename"></a></dt>
<dd><p>A named vector of quoted variables to rename.  The current
variable name should be on the left hand side of the name/value pair,
and the new variable name should be on the right.  The rename operation
is performed after the data step, the keep, and the drop.  Therefore,
the data steps should use the input variable name.  By default, all variables
retain their original names.</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>A vector of quoted variable names to use for by-group processing.
This parameter will activate the <code>first.</code> and <code>last.</code> automatic
variables, that indicate the first or last rows in a group.  These
automatic variables are useful for conditional processing on groups.
The function will also create first and last automatic variables for each
variable specified in the by group.</p></dd>


<dt id="arg-calculate">calculate<a class="anchor" aria-label="anchor" href="#arg-calculate"></a></dt>
<dd><p>Steps to set up calculated variables.
Calculated variables are commonly generated with summary functions such as
<code>mean</code>, <code>median</code>, <code>min</code>, <code>max</code>, etc.  It is more
efficient to set up calculated variables with the calculate parameter and then
use those variables in the data step, rather than perform the summary
function inside the data step.  The calculate block will be executed
immediately before the data step.</p></dd>


<dt id="arg-retain">retain<a class="anchor" aria-label="anchor" href="#arg-retain"></a></dt>
<dd><p>A list of variable names and initial values
to retain.  Retained variables will begin the data step with the initial
value.  Then for each iteration of the data step, the variable will
be populated with the ending value from the previous step.  The retain
functionality allows you to perform cumulative operations or decisions
based on the value of the previous iteration of the data step.  Initial
values should be of the expected data type for the column.  For example,
for a numeric column set the initial value to a zero, and for a
character column, set the initial value to an empty string, i.e.
<code>retain = list(col1 = 0, col2 = "")</code>.  There is no default initial
value for a variable.  You must supply an initial value for each retained
variable.</p></dd>


<dt id="arg-attrib">attrib<a class="anchor" aria-label="anchor" href="#arg-attrib"></a></dt>
<dd><p>A named list of attributes.  The list can be either
<code><a href="dsattr.html">dsattr</a></code> objects or single default values.  The <code>dsattr</code>
object allows you to set more attributes on each column.  The
single default value is convenient if you simply want to create a variable.
By default, variables will be created on the fly with no attributes.</p></dd>


<dt id="arg-arrays">arrays<a class="anchor" aria-label="anchor" href="#arg-arrays"></a></dt>
<dd><p>A named list of <code><a href="dsarray.html">dsarray</a></code> objects. The
<code>dsarray</code> is a list of columns which you can
iterate over inside the data step.  You can iterate over a <code>dsarray</code>
either with a <code>for</code> loop, or with a vectorized function.
The default value of the <code>arrays</code> parameter is NULL, meaning
no arrays are defined.</p></dd>


<dt id="arg-sort-check">sort_check<a class="anchor" aria-label="anchor" href="#arg-sort-check"></a></dt>
<dd><p>Checks to see if the input data is sorted according to
the <code>by</code> variable parameter.  The sort check will give an error
if the input data is not sorted according to the <code>by</code> variable.
The check is turned on if the value of
<code>sort_check</code> is TRUE, and turned off if FALSE.  The default value
is TRUE.  Turn the sort check off if you want to perform by-group
processing on unsorted data, or data that is not sorted according
to the by-group.</p></dd>


<dt id="arg-format">format<a class="anchor" aria-label="anchor" href="#arg-format"></a></dt>
<dd><p>A named list of formats to assign to the data
frame.  Formats will be assigned both before and after the datastep.</p></dd>


<dt id="arg-label">label<a class="anchor" aria-label="anchor" href="#arg-label"></a></dt>
<dd><p>A named list of labels to assign to the output data frame.</p></dd>


<dt id="arg-where">where<a class="anchor" aria-label="anchor" href="#arg-where"></a></dt>
<dd><p>An expression to filter the output dataset.  The where
clause will be applied prior to any drop, keep, or rename statement.
Use the <code>expression</code> function to assign the where clause.</p></dd>


<dt id="arg-set">set<a class="anchor" aria-label="anchor" href="#arg-set"></a></dt>
<dd><p>A dataset or list of datasets to append to the input
data frame.  The set operation will occur at the beginning of the datastep,
prior to the execution of any steps.  The columns in the set datasets
do not have to match.  Where there are no matching columns, the missing
values will be filled with NA.</p></dd>


<dt id="arg-merge">merge<a class="anchor" aria-label="anchor" href="#arg-merge"></a></dt>
<dd><p>A dataset or list of datasets to merge with the input
data.  The merge operation will occur at the beginning of the datastep,
prior to the execution of any steps.  When the <code>merge</code> operation is
requested, the <code>merge_by</code> parameter will be used to indicate which variable(s)
to merge by. If no <code>merge_by</code> is specified, the merge dataset columns will
simply be appended to the right of the input dataset.</p></dd>


<dt id="arg-merge-by">merge_by<a class="anchor" aria-label="anchor" href="#arg-merge-by"></a></dt>
<dd><p>If the <code>merge</code> parameter is set, the <code>merge_by</code>
parameter will be used to identify the variable(s) to merge by. If merge
variables are the same on both datasets, the names may be passed as a simple
quoted vector. If the variable names are different, pass the variables
to merge on as a named vector.  For example, <code>c("ITEMID" = "ITEMCODE")</code>
would specify that the join should occur on the "ITEMID" from the
dataset specified in the <code>data</code> parameter, and the "ITEMCODE"
variable from the dataset specified on the <code>merge</code> parameter.</p></dd>


<dt id="arg-merge-in">merge_in<a class="anchor" aria-label="anchor" href="#arg-merge-in"></a></dt>
<dd><p>A vector of column names to be used to hold the merge flags.
The number of names should correspond to the number of
datasets being merged. The
merge flags will be populated with 0 or 1 values to indicate whether the record
came from the corresponding table. Use the <code>where</code> parameter,
<code>delete</code> function, or <code>output</code> function to filter desired results.</p></dd>


<dt id="arg-log">log<a class="anchor" aria-label="anchor" href="#arg-log"></a></dt>
<dd><p>Whether or not to log the datastep.  Default is TRUE.  This
parameter is used internally.</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>The <code>subset</code> parameter accepts an <code>expression</code> object
that will be used to subset the data.  The <code>subset</code> expression will be
executed <strong>before</strong> the datastep executes.  In this regard, the
<code>subset</code> parameter on the R datastep is similar to the <code>where</code> clause
on the SAS datastep.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>The processed data frame, tibble, or data table.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Two parameters on the <code>datastep</code> function are required:
<strong>data</strong> and <strong>steps</strong>.  The <strong>data</strong> parameter is
the input data to the data step.  The <strong>steps</strong> parameter contains
the code statements you want to apply to the data. The <strong>steps</strong>
should be wrapped in curly braces.  When running, the data step
will loop through the input data row-by-row, and execute the steps for
each row.  Variables inside the data step can be accessed using
non-standard evaluation (meaning they  do not have to be quoted).</p>
<p>Note that the data step is pipe-friendly.  It can be used within
a <strong>dplyr</strong> pipeline.  The data step allows you to perform
deeply nested and complex conditionals within the pipeline.  The data
step is also very readable compared to other pipeline conditionals.</p>
    </div>
    <div id="automatic-variables">
    <h2>Automatic Variables</h2>


<p>The <code>datastep</code> function provides five automatic variables. These
variables are generated for every data step, and can
be accessed at any point within the data step:</p><ul><li><p><strong>data</strong>: Represents the entire input data frame.</p></li>
<li><p><strong>rw</strong>: Represents the current row.</p></li>
<li><p><strong>n.</strong>: Contains the row number.</p></li>
<li><p><strong>first.</strong>: Indicates the beginning of a by-group.</p></li>
<li><p><strong>last.</strong>: Indicates the end of a by-group.</p></li>
</ul><p>Automatic variables will be dropped from the data frame at the end
of the data step.  If you wish to keep the automatic variable values,
assign the automatic variable to a new variable and keep that variable.</p>
<p>If there are multiple by group variables, the <code>first.</code> and <code>last.</code>
automatic variables indicates a either/or combination of all by variables.
In addition,
<code>first.X</code> and <code>last.X</code> automatic variables will be created for
each variable, where "X" represents the name of the specified variable.
As always, these names are case-sensitive.</p>
    </div>
    <div id="column-attributes">
    <h2>Column Attributes</h2>


<p>To set attributes for a column on your data, use the <code>attrib</code>
parameter.  Example attributes include 'label', 'description',
and 'format'.  These types of attributes are set using a named list and a
<code><a href="dsattr.html">dsattr</a></code> object. The name of the list item
is the column name you want to set attributes on.
The value of the list item is the <code>dsattr</code> object.
For a complete list of available attributes,
see the <code><a href="dsattr.html">dsattr</a></code> documentation.</p>
<p>It should be mentioned  that the <code>dsattr</code> object is not required.
You can also set attributes with a name and a default value.
The default value can be any valid data value, such as a number or string.</p>
<p>The label and format attributes may also be set with the 'label' and
'format' parameters. These parameters accept a named list with the
labels or formats, and will be assigned to the output data frame.</p>
    </div>
    <div id="optional-parameters">
    <h2>Optional Parameters</h2>


<p>Optional parameters on the <code>datastep</code> allow you to shape
the output dataset or enhance the operation of the <code>datastep</code>.  Some
parameters are classified as input parameters, and others as output
parameters.  Input parameters modify the data before the data step
operations takes place.  Output parameters operate on the data
after the data step.</p>
<p>The <code>keep</code>, <code>drop</code>, and <code>rename</code> parameters
are output parameters.  These parameters will be applied after the
data step statements are executed.  Therefore, within the data step,
refer to variables using the input variable name. New variables may
be created on the fly, just by assigning a value to the new
variable name.</p>
<p>The <code>keep</code>, <code>drop</code>, and <code>rename</code> parameters require
quoted variable names, as the variables may not yet exist at the
time they are passed into the function.  Within a data step or
calculate block, however,
variable names do not need to be quoted.</p>
<p>The <code>calculate</code> parameter is used to perform vectorized functions
on the data prior to executing the data step.  For example, you
may want to determine a mean for a variable in the <code>calculate</code>
block, and then make decisions on that mean in the data step block.</p>
<p>The <code>retain</code> parameter allows you to access the prior row value.
At the start of the data step, the retained variable is seeded with the
initial value. For each subsequent step, the variable is seeded with the
value of the prior step/row.  This functionality allows you to increment
values or perform cumulative operations.</p>
<p><code>calculate</code> and <code>retain</code> are both input parameters.</p>
<p>The <code>subset</code> and <code>where</code> parameters can both be used to filter
the datastep data.  The difference is that <code>subset</code> is an input
parameter, and <code>where</code> is an output parameter.</p>
    </div>
    <div id="set-and-merge-operations">
    <h2>Set and Merge Operations</h2>


<p>The <code>datastep</code> function allows you to join one or more input datasets
into a single output dataset.  There are two operations in this regard:
"set" and "merge".  A set operation stacks the datasets vertically, one
on top of another. The merge operation joins the datasets horizontally,
left and right.</p>
<p>The <code>datastep</code> set and merge operations are unusually flexible compared
to other join functions in R. The set operation does not require the same
number of columns in each dataset.  Likewise, the merge operation does
not require the same number of rows.  In both cases, where there is no
corresponding column or row, the function will fill in with NA values.</p>
<p>The merge operation can perform both inner and outer joins.  By default,
the merge performs a full outer join.  If you wish to limit the operation
to an inner join, use the "merge_in" parameter to set up variables with
which you can filter the desired rows.  The "merge_in" variables will
be populated with 1 or 0 values, which indicate whether or not the
dataset contained that row.  Once these variables are populated, you
can easily limit the results using a <code>where</code> expression, or the
<code>delete</code> or <code>output</code> functions from inside the datastep.</p>
    </div>
    <div id="data-step-arrays">
    <h2>Data Step Arrays</h2>


<p>There are times you may want to iterate over columns in your data step.  Such
iteration is particularly useful when you have a wide dataset,
and wish to perform the same operation on several columns.
For instance, you may want to calculate the mean for 10 different
variables on your dataset.</p>
<p>The <code>arrays</code> parameter allows you to iterate across columns.
This parameter accepts a named list of
<code><a href="dsarray.html">dsarray</a></code> objects.  The <code>dsarray</code> is essentially
a list of columns.  You can use a <code>for</code> loop to iterate over the
<code>dsarray</code>, and also send it into a vectorized function.  Data
step arrays allow to you to perform row-wise calculations.
For instance, you can calculate
a sum or mean by row for the variables in your array.</p>
    </div>
    <div id="output-column-order">
    <h2>Output Column Order</h2>


<p>By default, the data step will retain the column order of any variables that
already exist on the input data set. New variables created
in a data step will be appended to the right of existing variables.
Yet these new variables can sometimes appear in an order that is
unexpected or undesirable.</p>
<p>There are two ways to control the order of output columns:
the <code>keep</code> parameter and the <code>attrib</code> parameter.</p>
<p>Columns names included on the
<code>keep</code> parameter will appear in the order indicated on the keep
vector.  This ordering mechanism is appropriate when you have a small
number of columns and can easily pass the entire keep list.</p>
<p>To control the order of new variables only, use the <code>attrib</code> parameter.
New variables for which attributes are defined will appear in the
order indicated on the <code>attrib</code> list.  The <code>attrib</code> list
is useful when you are adding a relatively small number of columns to
an existing data set, and don't want to pass all the column names.</p>
<p>Remember
that you can supply an attribute list with default values only,
such as <code>attrib = list(column1 = 0, column2 = "")</code>.  This style of
attribute definition is convenient if you are only trying to control
the order of columns.</p>
<p>If the above two mechanisms to control column order are not sufficient,
use the data frame subset operators or column ordering functions
provided by other packages.</p>
    </div>
    <div id="datastep-performance">
    <h2>Datastep Performance</h2>


<p>The <code>datastep</code> is intended to be used on small and medium-sized
datasets.  It is not recommended for large datasets.
If your dataset is greater than one million rows, you should consider
other techniques for processing your data.  While there is no
built-in restriction on the number of rows, performance of the
<code>datastep</code> can become unacceptable with a large number of rows.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="libname.html">libname</a></code> function to create a data library, and
the <code><a href="dictionary.html">dictionary</a></code> function to create a data dictionary.</p>
<p>Other datastep:
<code><a href="sub-.dsarray.html">[.dsarray</a>()</code>,
<code><a href="delete.html">delete</a>()</code>,
<code><a href="dsarray.html">dsarray</a>()</code>,
<code><a href="dsattr.html">dsattr</a>()</code>,
<code><a href="length.dsarray.html">length.dsarray</a>()</code>,
<code><a href="output.html">output</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># Example #1: Simple Data Step</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">datastep</span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span>, </span>
<span>               keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mpg"</span>, <span class="st">"cyl"</span>, <span class="st">"disp"</span>, <span class="st">"mpgcat"</span>, <span class="st">"recdt"</span>, <span class="st">"is8cyl"</span><span class="op">)</span>, <span class="op">{</span></span>
<span>                 </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">mpg</span> <span class="op">&gt;=</span> <span class="fl">20</span><span class="op">)</span> </span>
<span>    <span class="va">mpgcat</span> <span class="op">&lt;-</span> <span class="st">"High"</span></span>
<span>  <span class="kw">else</span> </span>
<span>    <span class="va">mpgcat</span> <span class="op">&lt;-</span> <span class="st">"Low"</span></span>
<span>                 </span>
<span>  <span class="va">recdt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1974-06-10"</span><span class="op">)</span></span>
<span>                 </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">cyl</span> <span class="op">==</span> <span class="fl">8</span><span class="op">)</span></span>
<span>    <span class="va">is8cyl</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span>  <span class="kw">else</span> </span>
<span>    <span class="va">is8cyl</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span>                 </span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span></span>
<span><span class="co">#                    mpg cyl  disp mpgcat      recdt</span></span>
<span><span class="co"># Mazda RX4         21.0   6 160.0   High 1974-06-10</span></span>
<span><span class="co"># Mazda RX4 Wag     21.0   6 160.0   High 1974-06-10</span></span>
<span><span class="co"># Datsun 710        22.8   4 108.0   High 1974-06-10</span></span>
<span><span class="co"># Hornet 4 Drive    21.4   6 258.0   High 1974-06-10</span></span>
<span><span class="co"># Hornet Sportabout 18.7   8 360.0    Low 1974-06-10</span></span>
<span><span class="co"># Valiant           18.1   6 225.0    Low 1974-06-10</span></span>
<span><span class="co"># Duster 360        14.3   8 360.0    Low 1974-06-10</span></span>
<span><span class="co"># Merc 240D         24.4   4 146.7   High 1974-06-10</span></span>
<span><span class="co"># Merc 230          22.8   4 140.8   High 1974-06-10</span></span>
<span><span class="co"># Merc 280          19.2   6 167.6    Low 1974-06-10</span></span>
<span></span>
<span><span class="co"># Example #2: By-group Processing</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">datastep</span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span>, </span>
<span>               keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mpg"</span>, <span class="st">"cyl"</span>, <span class="st">"gear"</span>, <span class="st">"grp"</span><span class="op">)</span>, </span>
<span>               by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gear"</span><span class="op">)</span>, sort_check <span class="op">=</span> <span class="cn">FALSE</span>, <span class="op">{</span></span>
<span>                 </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">first.</span><span class="op">)</span></span>
<span>    <span class="va">grp</span> <span class="op">&lt;-</span> <span class="st">"Start"</span></span>
<span>  <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">last.</span><span class="op">)</span></span>
<span>    <span class="va">grp</span> <span class="op">&lt;-</span> <span class="st">"End"</span></span>
<span>  <span class="kw">else</span> </span>
<span>    <span class="va">grp</span> <span class="op">&lt;-</span> <span class="st">"-"</span></span>
<span>                 </span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span></span>
<span><span class="co">#                    mpg cyl gear   grp</span></span>
<span><span class="co"># Mazda RX4         21.0   6    4 Start</span></span>
<span><span class="co"># Mazda RX4 Wag     21.0   6    4     -</span></span>
<span><span class="co"># Datsun 710        22.8   4    4   End</span></span>
<span><span class="co"># Hornet 4 Drive    21.4   6    3 Start</span></span>
<span><span class="co"># Hornet Sportabout 18.7   8    3     -</span></span>
<span><span class="co"># Valiant           18.1   6    3     -</span></span>
<span><span class="co"># Duster 360        14.3   8    3   End</span></span>
<span><span class="co"># Merc 240D         24.4   4    4 Start</span></span>
<span><span class="co"># Merc 230          22.8   4    4     -</span></span>
<span><span class="co"># Merc 280          19.2   6    4   End </span></span>
<span></span>
<span><span class="co"># Example #3: Calculate Block</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">datastep</span><span class="op">(</span><span class="va">mtcars</span>, </span>
<span>               keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mpg"</span>, <span class="st">"cyl"</span>, <span class="st">"mean_mpg"</span>, <span class="st">"mpgcat"</span><span class="op">)</span>, </span>
<span>               calculate <span class="op">=</span> <span class="op">{</span> <span class="va">mean_mpg</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span> <span class="op">}</span>, <span class="op">{</span></span>
<span>                 </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">mpg</span> <span class="op">&gt;=</span> <span class="va">mean_mpg</span><span class="op">)</span></span>
<span>    <span class="va">mpgcat</span> <span class="op">&lt;-</span> <span class="st">"High"</span></span>
<span>  <span class="kw">else</span> </span>
<span>    <span class="va">mpgcat</span> <span class="op">&lt;-</span> <span class="st">"Low"</span></span>
<span>                 </span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span>
<span><span class="co">#                    mpg cyl mean_mpg mpgcat</span></span>
<span><span class="co"># Mazda RX4         21.0   6 20.09062   High</span></span>
<span><span class="co"># Mazda RX4 Wag     21.0   6 20.09062   High</span></span>
<span><span class="co"># Datsun 710        22.8   4 20.09062   High</span></span>
<span><span class="co"># Hornet 4 Drive    21.4   6 20.09062   High</span></span>
<span><span class="co"># Hornet Sportabout 18.7   8 20.09062    Low</span></span>
<span><span class="co"># Valiant           18.1   6 20.09062    Low</span></span>
<span><span class="co"># Duster 360        14.3   8 20.09062    Low</span></span>
<span><span class="co"># Merc 240D         24.4   4 20.09062   High</span></span>
<span><span class="co"># Merc 230          22.8   4 20.09062   High</span></span>
<span><span class="co"># Merc 280          19.2   6 20.09062    Low</span></span>
<span></span>
<span><span class="co"># Example #4: Data pipeline</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add datastep to dplyr pipeline</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">cyl</span>, <span class="va">gear</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>mean_mpg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">datastep</span><span class="op">(</span><span class="op">{</span></span>
<span>    </span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">mpg</span> <span class="op">&gt;=</span> <span class="va">mean_mpg</span><span class="op">)</span></span>
<span>      <span class="va">mpgcat</span> <span class="op">&lt;-</span> <span class="st">"High"</span></span>
<span>    <span class="kw">else</span> </span>
<span>      <span class="va">mpgcat</span> <span class="op">&lt;-</span> <span class="st">"Low"</span></span>
<span>    </span>
<span>  <span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span></span>
<span><span class="co">#     mpg cyl gear mean_mpg mpgcat</span></span>
<span><span class="co"># 1  21.0   6    4 20.09062   High</span></span>
<span><span class="co"># 2  21.0   6    4 20.09062   High</span></span>
<span><span class="co"># 3  22.8   4    4 20.09062   High</span></span>
<span><span class="co"># 4  21.4   6    3 20.09062   High</span></span>
<span><span class="co"># 5  18.7   8    3 20.09062    Low</span></span>
<span><span class="co"># 6  18.1   6    3 20.09062    Low</span></span>
<span><span class="co"># 7  14.3   8    3 20.09062    Low</span></span>
<span><span class="co"># 8  24.4   4    4 20.09062   High</span></span>
<span><span class="co"># 9  22.8   4    4 20.09062   High</span></span>
<span><span class="co"># 10 19.2   6    4 20.09062    Low</span></span>
<span></span>
<span><span class="co"># Example #5: Drop, Retain and Rename</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">datastep</span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span>, </span>
<span>               drop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"disp"</span>, <span class="st">"hp"</span>, <span class="st">"drat"</span>, <span class="st">"qsec"</span>, </span>
<span>                        <span class="st">"vs"</span>, <span class="st">"am"</span>, <span class="st">"gear"</span>, <span class="st">"carb"</span><span class="op">)</span>, </span>
<span>               retain <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cumwt <span class="op">=</span> <span class="fl">0</span> <span class="op">)</span>,</span>
<span>               rename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mpg <span class="op">=</span> <span class="st">"MPG"</span>, cyl <span class="op">=</span> <span class="st">"Cylinders"</span>, wt <span class="op">=</span> <span class="st">"Wgt"</span>, </span>
<span>                          cumwt <span class="op">=</span> <span class="st">"Cumulative Wgt"</span><span class="op">)</span>, <span class="op">{</span></span>
<span>                 </span>
<span>  <span class="va">cumwt</span> <span class="op">&lt;-</span> <span class="va">cumwt</span> <span class="op">+</span> <span class="va">wt</span></span>
<span>                 </span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span></span>
<span><span class="co">#                    MPG Cylinders   Wgt Cumulative Wgt</span></span>
<span><span class="co"># Mazda RX4         21.0         6 2.620          2.620</span></span>
<span><span class="co"># Mazda RX4 Wag     21.0         6 2.875          5.495</span></span>
<span><span class="co"># Datsun 710        22.8         4 2.320          7.815</span></span>
<span><span class="co"># Hornet 4 Drive    21.4         6 3.215         11.030</span></span>
<span><span class="co"># Hornet Sportabout 18.7         8 3.440         14.470</span></span>
<span><span class="co"># Valiant           18.1         6 3.460         17.930</span></span>
<span><span class="co"># Duster 360        14.3         8 3.570         21.500</span></span>
<span><span class="co"># Merc 240D         24.4         4 3.190         24.690</span></span>
<span><span class="co"># Merc 230          22.8         4 3.150         27.840</span></span>
<span><span class="co"># Merc 280          19.2         6 3.440         31.280</span></span>
<span></span>
<span><span class="co"># Example #6: Attributes and Arrays</span></span>
<span></span>
<span><span class="co"># Create sample data</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span>header <span class="op">=</span> <span class="cn">TRUE</span>, text <span class="op">=</span> <span class="st">'</span></span>
<span><span class="st">   Year  Q1   Q2  Q3  Q4</span></span>
<span><span class="st">   2000 125  137 152 140</span></span>
<span><span class="st">   2001 132  145 138  87</span></span>
<span><span class="st">   2002 101  104 115 121'</span><span class="op">)</span></span>
<span> </span>
<span><span class="co"># Use attrib list to control column order and add labels</span></span>
<span><span class="co"># Use array to calculate row sums and means, and get best quarter</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">datastep</span><span class="op">(</span><span class="va">dat</span>,</span>
<span>               attrib <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Tot <span class="op">=</span> <span class="fu"><a href="dsattr.html">dsattr</a></span><span class="op">(</span><span class="fl">0</span>, label <span class="op">=</span> <span class="st">"Year Total"</span><span class="op">)</span>,</span>
<span>                             Avg <span class="op">=</span> <span class="fu"><a href="dsattr.html">dsattr</a></span><span class="op">(</span><span class="fl">0</span>, label <span class="op">=</span> <span class="st">"Year Average"</span><span class="op">)</span>,</span>
<span>                             Best <span class="op">=</span> <span class="fu"><a href="dsattr.html">dsattr</a></span><span class="op">(</span><span class="fl">0</span>, label <span class="op">=</span> <span class="st">"Best Quarter"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>               arrays <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>qtrs <span class="op">=</span> <span class="fu"><a href="dsarray.html">dsarray</a></span><span class="op">(</span><span class="st">"Q1"</span>, <span class="st">"Q2"</span>, <span class="st">"Q3"</span>, <span class="st">"Q4"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>               drop <span class="op">=</span> <span class="st">"q"</span>,</span>
<span>               steps <span class="op">=</span> <span class="op">{</span></span>
<span>               </span>
<span>                 <span class="co"># Empty brackets return all array values</span></span>
<span>                 <span class="va">Tot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">qtrs</span><span class="op">[</span><span class="op">]</span><span class="op">)</span></span>
<span>                 <span class="va">Avg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">qtrs</span><span class="op">[</span><span class="op">]</span><span class="op">)</span></span>
<span>                 </span>
<span>                 <span class="co"># Iterate to find best quarter</span></span>
<span>                 <span class="kw">for</span> <span class="op">(</span><span class="va">q</span> <span class="kw">in</span> <span class="va">qtrs</span><span class="op">)</span> <span class="op">{</span></span>
<span>                   <span class="kw">if</span> <span class="op">(</span><span class="va">qtrs</span><span class="op">[</span><span class="va">q</span><span class="op">]</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">qtrs</span><span class="op">[</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>                     <span class="va">Best</span> <span class="op">&lt;-</span> <span class="va">q</span></span>
<span>                 <span class="op">}</span></span>
<span>               <span class="op">}</span><span class="op">)</span></span>
<span>               </span>
<span><span class="va">df</span></span>
<span><span class="co">#   Year  Q1  Q2  Q3  Q4 Tot    Avg Best</span></span>
<span><span class="co"># 1 2000 125 137 152 140 554 138.50   Q3</span></span>
<span><span class="co"># 2 2001 132 145 138  87 502 125.50   Q2</span></span>
<span><span class="co"># 3 2002 101 104 115 121 441 110.25   Q4</span></span>
<span></span>
<span><span class="fu"><a href="dictionary.html">dictionary</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#   A tibble: 8 x 10</span></span>
<span><span class="co">#   Name  Column Class     Label        Description Format Width Justify  Rows   NAs</span></span>
<span><span class="co">#   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;        &lt;chr&gt;       &lt;lgl&gt;  &lt;int&gt; &lt;chr&gt;   &lt;int&gt; &lt;int&gt;</span></span>
<span><span class="co"># 1 df    Year   integer   NA           NA          NA        NA NA          3     0</span></span>
<span><span class="co"># 2 df    Q1     integer   NA           NA          NA        NA NA          3     0</span></span>
<span><span class="co"># 3 df    Q2     integer   NA           NA          NA        NA NA          3     0</span></span>
<span><span class="co"># 4 df    Q3     integer   NA           NA          NA        NA NA          3     0</span></span>
<span><span class="co"># 5 df    Q4     integer   NA           NA          NA        NA NA          3     0</span></span>
<span><span class="co"># 6 df    Tot    integer   Year Total   NA          NA        NA NA          3     0</span></span>
<span><span class="co"># 7 df    Avg    numeric   Year Average NA          NA        NA NA          3     0</span></span>
<span><span class="co"># 8 df    Best   character Best Quarter NA          NA         2 NA          3     0</span></span>
<span></span>
<span><span class="co"># Example #7: Set and Merge Operations</span></span>
<span></span>
<span><span class="co"># Create sample data</span></span>
<span><span class="va">grp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span>header <span class="op">=</span> <span class="cn">TRUE</span>, text <span class="op">=</span> <span class="st">'</span></span>
<span><span class="st">  GROUP  NAME</span></span>
<span><span class="st">  G01  Group1</span></span>
<span><span class="st">  G02  Group2</span></span>
<span><span class="st">'</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">grp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span>header <span class="op">=</span> <span class="cn">TRUE</span>, text <span class="op">=</span> <span class="st">'</span></span>
<span><span class="st">  GROUP  NAME</span></span>
<span><span class="st">  G03  Group3</span></span>
<span><span class="st">  G04  Group4</span></span>
<span><span class="st">'</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span>header <span class="op">=</span> <span class="cn">TRUE</span>, text <span class="op">=</span> <span class="st">'</span></span>
<span><span class="st">  ID AGE SEX GROUP</span></span>
<span><span class="st">  A01 58 F    G01</span></span>
<span><span class="st">  A02 20 M    G02</span></span>
<span><span class="st">  A03 47 F    G05</span></span>
<span><span class="st">  A04 11 M    G03</span></span>
<span><span class="st">  A05 23 F    G01</span></span>
<span><span class="st">'</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set operation</span></span>
<span><span class="va">grps</span> <span class="op">&lt;-</span> <span class="fu">datastep</span><span class="op">(</span><span class="va">grp1</span>, set <span class="op">=</span> <span class="va">grp2</span>, <span class="op">{</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">grps</span></span>
<span><span class="co">#   GROUP   NAME</span></span>
<span><span class="co"># 1   G01 Group1</span></span>
<span><span class="co"># 2   G02 Group2</span></span>
<span><span class="co"># 3   G03 Group3</span></span>
<span><span class="co"># 4   G04 Group4</span></span>
<span></span>
<span><span class="co"># Merge operation - Outer Join</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">datastep</span><span class="op">(</span><span class="va">dat</span>, merge <span class="op">=</span> <span class="va">grps</span>, </span>
<span>                merge_by <span class="op">=</span> <span class="st">"GROUP"</span>, </span>
<span>                merge_in <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"inA"</span>, <span class="st">"inB"</span><span class="op">)</span>, <span class="op">{</span><span class="op">}</span><span class="op">)</span></span>
<span>                </span>
<span><span class="co"># View results</span></span>
<span><span class="va">res</span></span>
<span><span class="co">#     ID AGE  SEX GROUP   NAME inA inB</span></span>
<span><span class="co"># 1  A01  58    F   G01 Group1   1   1</span></span>
<span><span class="co"># 2  A05  23    F   G01 Group1   1   1</span></span>
<span><span class="co"># 3  A02  20    M   G02 Group2   1   1</span></span>
<span><span class="co"># 4  A04  11    M   G03 Group3   1   1</span></span>
<span><span class="co"># 5  A03  47    F   G05   &lt;NA&gt;   1   0</span></span>
<span><span class="co"># 6 &lt;NA&gt;  NA &lt;NA&gt;   G04 Group4   0   1</span></span>
<span></span>
<span><span class="co"># Merge operation - Inner Join</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">datastep</span><span class="op">(</span><span class="va">dat</span>, merge <span class="op">=</span> <span class="va">grps</span>, </span>
<span>                merge_by <span class="op">=</span> <span class="st">"GROUP"</span>, </span>
<span>                merge_in <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"inA"</span>, <span class="st">"inB"</span><span class="op">)</span>, </span>
<span>                where <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">inA</span> <span class="op">&amp;</span> <span class="va">inB</span><span class="op">)</span>, <span class="op">{</span><span class="op">}</span><span class="op">)</span></span>
<span>                </span>
<span><span class="co"># View results</span></span>
<span><span class="va">res</span></span>
<span><span class="co">#     ID AGE  SEX GROUP   NAME inA inB</span></span>
<span><span class="co"># 1  A01  58    F   G01 Group1   1   1</span></span>
<span><span class="co"># 2  A05  23    F   G01 Group1   1   1</span></span>
<span><span class="co"># 3  A02  20    M   G02 Group2   1   1</span></span>
<span><span class="co"># 4  A04  11    M   G03 Group3   1   1</span></span>
<span></span>
<span><span class="co"># Example #8: Data NULL</span></span>
<span></span>
<span><span class="co"># Create new dataset using output() functions.</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">datastep</span><span class="op">(</span><span class="cn">NULL</span>, </span>
<span>                <span class="op">{</span></span>
<span>                  <span class="va">ID</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span>                  <span class="va">Item</span> <span class="op">&lt;-</span> <span class="st">"Pencil"</span></span>
<span>                  <span class="fu"><a href="output.html">output</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>                  <span class="va">ID</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span>                  <span class="va">Item</span> <span class="op">&lt;-</span> <span class="st">"Scissors"</span></span>
<span>                  <span class="fu"><a href="output.html">output</a></span><span class="op">(</span><span class="op">)</span></span>
<span>                <span class="op">}</span><span class="op">)</span></span>
<span> </span>
<span><span class="co"># View results</span></span>
<span><span class="va">res</span></span>
<span><span class="co">#    ID     Item</span></span>
<span><span class="co"># 1  10   Pencil</span></span>
<span><span class="co"># 2  20 Scissors</span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by David Bosak.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

